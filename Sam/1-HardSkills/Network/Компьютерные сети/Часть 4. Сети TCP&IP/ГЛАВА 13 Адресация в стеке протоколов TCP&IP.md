# ГЛАВА 13 Адресация в стеке протоколов TCP&IP
Главное достоинство этой технологии в *гибкости* и *масштабируемости* системы адресации.
Основными задачами адресации являются следующие:
□ Согласованное использование адресов различного типа. Эта задача включает отображение адресов разных типов друг на друга, например сетевого IP-адреса на локальный,
доменного имени — на 1Р-адрес.
□ Обеспечение уникальности адресов. В зависимости от типа адреса требуется обеспечивать однозначность адресации в пределах компьютера, подсети, корпоративной сети
или Интернета.
□ Конфигурирование сетевых интерфейсов и сетевых приложений.

Ключевым словом, которое характеризует принятый в TCP/IP подход к решению этих
проблем, является **масштабируемость**. 

>В этой главе речь идет о системе адресации, используемой в четвертой версии протокола IPv4, которая существенно отличается от системы адресации в версии IPv6. Особенности IPv6 рассматриваются в главе 17.

## Структура стека протоколов TCP/IP
Стек имеет иерархическую, четырехуровневую структуру
![[Pasted image 20221008135202.png|400]]

- **Прикладной уровень** стека TCP/IP соответствует трем верхним уровням модели OSI: прикладному, представления и сеансовому.
- **Транспортный уровень** стека TCP/IP может предоставлять вышележащему уровню два типа сервиса:
	- гарантированную доставку обеспечивает **протокол управления передачей** (Transmission Control Protocol, **TCP**);
	- доставку по возможности, или с максимальными усилиями, обеспечивает **протокол пользовательских дейтаграмм** (User Datagram Protocol, **UDP**).
- **Сетевой уровень**, называемый также уровнем Интернета, является стержнем всей архитектуры TCP/IP. Протоколы сетевого уровня поддерживают интерфейс с вышележащим транспортным уровнем, получая от него запросы на передачу данных по составной сети, а также с нижележащим уровнем сетевых интерфейсов. Основным протоколом сетевого уровня является межсетевой протокол (Internet Protocol, **IP**). В его задачу входит продвижение пакета между сетями — от одного маршрутизатора к другому до тех пор, пока пакет не попадет в сеть назначения. 

В отличие от протоколов прикладного и транспортного уровней, протокол IP развертывается не только на хостах, но и на всех маршрутизаторах. Протокол IP — это дейтаграммный протокол, работающий без установления соединений по принципу доставки с максимальными усилиями. Такой тип сетевого сервиса называют также «ненадежным». К сетевому уровню TCP/IP часто относят протоколы, выполняющие вспомогательные функции по отношению к IP. Это прежде всего протоколы маршрутизации RIP и OSPF, предназначенные для изучения топологии сети, определения маршрутов и составления таблиц маршрутизации, на основании которых протокол IP перемещает пакеты в нужном направлении. По этой же причине к сетевому уровню могут быть отнесены протокол межсетевых управляющих сообщений (Internet Control Message Protocol, ICMP), предназначенный для передачи маршрутизатором источнику сведений об ошибках, возникших при передаче пакета, и некоторые другие протоколы.

>Идеологическим отличием архитектуры стека TCP/IP от многоуровневой архитектуры других стеков является интерпретация функций самого нижнего уровня — **уровня сетевых интерфейсов**.

>Любая коммуникационная среда, которая позволяет двум или более IP-узлам непосредственно взаимодействовать друг с другом без промежуточных маршрутизаторов, рассматривается протоколом IP как одна **линия связи (Link)**, как если бы эти узлы были связаны отрезком кабеля. В простейшем случае такая коммуникационная среда может действительно представлять собой отдельную физическую линию связи с работающим на ней протоколом канального уровня, например Ethernet или РРР. Более сложным случаем является локальная сеть, построенная на коммутаторах. Но поскольку она также является доменом широковещания, то для протокола IP эта коммутируемая среда неотличима от физической линии связи.

Подчеркнем, что если локальная сеть разбита на виртуальные локальные сети VLAN для
протокола IP, то она представляет собой уже несколько линий связи, по числу VLAN, так
как широковещание ограничивается пределами отдельной VLAN. В том случае, когда
коммуникационная среда, работающая под IP, не поддерживает широковещание, она
рассматривается не как одна линия связи, а как набор отдельных линий связи, например,
MPLS является такой средой и отдельные логические каналы MPLS рассматриваются
протоколом IP как отдельные связи.

Задачу организации интерфейса между технологией TCP/IP и любой другой технологией промежуточной сети упрощенно можно свести к двум задачам:
□ упаковка (инкапсуляция) IP-пакета в единицу передаваемых данных промежуточной
сети;
□ преобразование сетевых IP-адресов в адреса технологии данной промежуточной сети.

Каждый коммуникационный протокол оперирует некоторой единицей передаваемых данных. Названия этих единиц иногда закрепляются стандартом, а чаще просто определяются традицией. В стеке TCP/IP за многие годы его существования образовалась устоявшаяся терминология в этой области
![[Pasted image 20221008141718.png|460]]

## Типы адресов стека TCP/IP
Для идентификации сетевых интерфейсов используются три типа адресов:
- локальные (аппаратные) адреса;
- сетевые адреса (1Р-адреса);
- символьные (доменные) имена.

В разных сетевых технологиях в общем случае используются собственные системы адресации, предназначенные исключительно для обеспечения связи собственных узлов. Но как только некоторая сеть объединяется с другими сетями в составную, функциональность этих адресов расширяется, они становятся необходимым элементом вышележащей объединяющей технологии — в данном случае технологии TCP/IP. Роль, которую играют эти адреса в TCP/IP, не зависит от того, какая именно технология применяется в подсети, поэтому они имеют общее название — **локальные** **(аппаратные) адреса**. Например, если в составную сеть включена подсеть Ethernet, то локальными адресами сетевых интерфейсов этой сети для технологии TCP/IP будут соответственно МАС-адреса, а если подсеть ATM — то номера виртуальных каналов.

Чтобы технология TCP/IP могла решать свою задачу объединения сетей, ей необходима собственная глобальная система адресации, позволяющая универсальным и однозначным способом идентифицировать любой интерфейс составной сети. Очевидным решением является нумерация всех подсетей составной сети, а затем нумерация сетевых интерфейсов в пределах каждой из этих подсетей. Пара, состоящая из номера сети и номера узла1, отвечает поставленным условиям и может служить в качестве **сетевого адреса**, или **IP-адреса**. Сетевой адрес представляет собой набор чисел, например 192.45.66.17. 

Числовое представление сетевого адреса достаточно эффективно для программных и аппаратных средств. Однако пользователи обычно предпочитают работать с более удобными **символьными именами** компьютеров. Именно с символьными именами вы имеете дело, когда задаете веб-браузеру адрес доступа к тому или иному сайту Интернета. Символьные имена в пределах составной сети строятся по иерархическому признаку. Примером доменного имени может служить имя base2.sales.zil.ru. Символьные имена называют также **доменными именами** или **DNS-именами**.

Между локальным адресом, доменным именем и IP-адресом, относящимся к одному и тому же сетевому интерфейсу, нет функциональной зависимости, поэтому единственный путь получить отображение адреса одного типа в адрес другого типа — это построить таблицу соответствия. 

>В общем случае сетевой интерфейс может иметь несколько локальных адресов, сетевых адресов, доменных имен.

## Формат IP-адреса
В заголовке IP-пакета предусмотрены поля для хранения IP-адреса отправителя и IP-
адреса получателя. 